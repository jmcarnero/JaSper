/*! JaSper v3.4 | (c) 2015 José M. Carnero (sargazos.net) | JaSper_rest v1.0b */
JaSper.extend(JaSper.prototype,{rest:function(e,t,n,a){"use strict";return"get"!=e&&"post"!=e&&JaSper.log("[JaSper::rest] Tipo de petición desconocido o no soportado.",1),JaSper.rest[e](t,n,a),this}}),JaSper.rest={auth:function(e,t){"use strict";var n="",a=JaSper.cookie.get("JaSper_RestToken");if(!a&&e&&!md5&&!sha1){JaSper.load.script("md5.min.js"),JaSper.load.script("sha1.min.js");for(var r=0;50>r;r++){if("function"==typeof md5&&"function"==typeof sha1){a=sha1(sha1(e)+md5(t));break}JaSper.time.wait(100)}}if(!a)return JaSper.log("-JaSper::rest.auth- Sin token de seguridad",1),oReturn;var o=Math.floor((new Date).getTime()/1e3);return n=sha1(a+o)+o,JaSper.cookie.set("JaSper_RestToken",a,30),n},get:function(e,t,n){"use strict";if(!e)return JaSper.log("-JaSper::rest.get- Sin URL que consultar",1),!1;n=n||{},n.start=n.start||function(){console.log("Start")},n.end=n.end||function(){console.log("End")},n.fail=n.fail||function(){console.log("Fail")};var a=function(){var a={contentType:"application/json; charset=utf-8"},r="json";JaSper.ajax.send({url:e,cabeceras:a,valores:t,metodo:"get",asincrono:null,formatoDatos:r,elementoDom:null,cbEnd:function(e,t){return n.end(t)},cbFail:function(e,t){return n.fail(t)},cbStart:function(e,t){return n.start(t)}})};if(JaSper.ajax)a.call(null);else{JaSper.load.queue.push({fn:a,ctx:null});var r=JaSper.minificado?"_min":"";JaSper.load.script("JaSper_ajax"+r+".js")}return!0},post:function(e,t,n){"use strict";if(!e)return JaSper.log("-JaSper::rest.post- Sin URL que consultar",1),!1;n=n||{},n.start=n.start||function(){console.log("Start")},n.end=n.end||function(){console.log("End")},n.fail=n.fail||function(){console.log("Fail")};var a=function(){var a={contentType:"application/json; charset=utf-8"},r="json";JaSper.ajax.send({url:e,cabeceras:a,valores:t,metodo:"post",asincrono:null,formatoDatos:r,elementoDom:null,cbEnd:function(e,t){return n.end(t)},cbFail:function(e,t){return n.fail(t)},cbStart:function(e,t){return n.start(t)}})};if(JaSper.ajax)a.call(null);else{JaSper.load.queue.push({fn:a,ctx:null});var r=JaSper.minificado?"_min":"";JaSper.load.script("JaSper_ajax"+r+".js")}return!0},sign:function(e,t){"use strict";e=e||{};var n="",a=t||JaSper.cookie.auth();if(!sha1||!a)return null;for(var r in e)e[r]&&(n+=e[r]);return sRet=a,n&&(sRet=sha1(a+n)),sRet}};
