/*! JaSper v3.5 | (c) 2015 José M. Carnero (sargazos.net) | JaSper_rest v1.0b */
JaSper.extend(JaSper.prototype,{rest:function(a,b,c,d){"use strict";return"get"!=a&&"post"!=a&&JaSper.log("[JaSper::rest] Tipo de petición desconocido o no soportado.",1),JaSper.rest[a](b,c,d),this}}),JaSper.rest={auth:function(a,b,c){"use strict";var d="",e=JaSper.cookie.get("JaSper_RestToken");if(!e&&a&&!md5&&!sha1){JaSper.load.script("md5.min.js"),JaSper.load.script("sha1.min.js");for(var f=0;f<50;f++){if("function"==typeof md5&&"function"==typeof sha1){e=sha1(sha1(a)+md5(b));break}JaSper.time.wait(100)}}if(!e)return JaSper.log("-JaSper::rest.auth- Sin token de seguridad",1),oReturn;var g=Math.floor((new Date).getTime()/1e3);return d=sha1(e+g)+g,JaSper.cookie.set("JaSper_RestToken",e,30),d},get:function(a,b,c){"use strict";if(!a)return JaSper.log("-JaSper::rest.get- Sin URL que consultar",1),!1;c=c||{},c.start=c.start||function(a){console.log("Start")},c.end=c.end||function(a){console.log("End")},c.fail=c.fail||function(a){console.log("Fail")};var d=function(){var d={contentType:"application/json; charset=utf-8"},e="json";JaSper.ajax.send({url:a,cabeceras:d,valores:b,metodo:"get",asincrono:null,formatoDatos:e,elementoDom:null,cbEnd:function(a,b){return c.end(b)},cbFail:function(a,b){return c.fail(b)},cbStart:function(a,b){return c.start(b)}})};return JaSper.ajax?d.call(null):(JaSper.load.queue.push({fn:d,ctx:null}),JaSper.load.script("JaSper_ajax"+JaSper.trait.minificado+".js")),!0},post:function(a,b,c){"use strict";if(!a)return JaSper.log("-JaSper::rest.post- Sin URL que consultar",1),!1;c=c||{},c.start=c.start||function(a){console.log("Start")},c.end=c.end||function(a){console.log("End")},c.fail=c.fail||function(a){console.log("Fail")};var d=function(){var d={contentType:"application/json; charset=utf-8"},e="json";JaSper.ajax.send({url:a,cabeceras:d,valores:b,metodo:"post",asincrono:null,formatoDatos:e,elementoDom:null,cbEnd:function(a,b){return c.end(b)},cbFail:function(a,b){return c.fail(b)},cbStart:function(a,b){return c.start(b)}})};return JaSper.ajax?d.call(null):(JaSper.load.queue.push({fn:d,ctx:null}),JaSper.load.script("JaSper_ajax"+JaSper.trait.minificado+".js")),!0},sign:function(a,b){"use strict";a=a||{};var c="",d=b||JaSper.cookie.auth();if(!sha1||!d)return null;for(var e in a)a[e]&&(c+=a[e]);return sRet=d,c&&(sRet=sha1(d+c)),sRet}};
