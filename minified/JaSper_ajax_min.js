/*! JaSper v3.5 | (c) 2015 José M. Carnero (sargazos.net) | JaSper_ajax v1.0 */
JaSper.extend(JaSper.langs,{en:{"ajax/ajax_1":"This browser can't create AJAX objects.","ajax/ajax_2":"Loading","ajax/ajax_3":"The AJAX request was empty.\nMaybe the destination URL is not accesible from this script.","ajax/ajax_4":"Unauthorized (code 401).","ajax/ajax_5":"Forbidden (code 403).","ajax/ajax_6":"Not Found (code 404).","ajax/ajax_7":"Error"},es:{"ajax/ajax_1":"Su navegador no puede crear objetos AJAX.","ajax/ajax_2":"Cargando","ajax/ajax_3":"La respuesta AJAX está vacía.\nPuede que la URL de destino no sea accesible desde esta máquina/dominio.","ajax/ajax_4":"No tiene autorización (código 401).","ajax/ajax_5":"Acceso no permitido (código 403).","ajax/ajax_6":"La dirección no existe (código 404).","ajax/ajax_7":"Error"}}),JaSper.extend(JaSper.prototype,{ajax:function(a,b,c){"use strict";if("object"==typeof a)var d=a,a=d.url||null,e=d.cabeceras||{},b=d.valores||null,c=d.metodo||null,f=d.asincrono||null,g=d.formatoDatos||"text",h=d.cbEnd||null,i=d.cbStart||null,j=d.cbFail||null;return h=h||function(a,b){"INPUT"==a.tagName?a.value=b.responseText:a.innerHTML=b.responseText},i=i||function(a,b){a.innerHTML=JaSper._t("ajax/ajax_2")+"..."},j=j||function(a,b){switch(b.status){case 0:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_3"),1),a.innerHTML=JaSper._t("ajax/ajax_3");break;case 401:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_4"),1),a.innerHTML=JaSper._t("ajax/ajax_4");break;case 403:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_5"),1),a.innerHTML=JaSper._t("ajax/ajax_5");break;case 404:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_6"),1),a.innerHTML=JaSper._t("ajax/ajax_6");break;default:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_7")+": "+b.status+", "+b.statusText+" ("+b.responseText+")",2),a.innerHTML=JaSper._t("ajax/ajax_7")+": "+b.status}},this.each(function(a,b,c,d,e,f){JaSper.ajax.send({url:a,cabeceras:b,valores:c,metodo:d,asincrono:e,formatoDatos:f,elementoDom:this,cbEnd:h,cbFail:j,cbStart:i})},[a,e,b,c,f,g]),this}}),JaSper.ajax={nuevo:function(){"use strict";var a=!1;if("undefined"!=typeof XMLHttpRequest)a=new XMLHttpRequest;else try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP.4.0")}catch(a){JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_1"),2)}}}return a||JaSper.log("-JaSper::nuevoAjax- No se pudo crear el objeto AJAX.",2),a},send:function(a){"use strict";if("object"!=typeof a||!a.url)return JaSper.log("-JaSper::ajax.send- Sin URL que consultar",1),!1;a.cabeceras=a.cabeceras||{},a.valores=a.valores||null,a.metodo=(a.metodo||"get").toUpperCase(),a.asincrono="boolean"!=typeof a.asincrono||a.asincrono,a.returnData=a.returnData||"text",a.elementoDom=a.elementoDom||null,a.cbEnd=a.cbEnd||function(a,b){JaSper.log(b.responseText)},a.cbStart=a.cbStart||function(a,b){JaSper.log(JaSper._t("ajax/ajax_2")+"...")},a.cbFail=a.cbFail||function(a,b){switch(b.status){case 0:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_3"),1);break;case 401:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_4"),1);break;case 403:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_5"),1);break;case 404:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_6"),1);break;default:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_7")+": "+b.status+", "+b.statusText+" ("+b.responseText+")",2)}};var b=JaSper.ajax.nuevo();if(!b)return JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_1")),a.elementoDom&&(a.elementoDom.innerHTML=JaSper._t("ajax/ajax_1")),!1;b.open(a.metodo,a.url,a.asincrono),"POST"==a.metodo&&(b.setRequestHeader("Method","POST "+a.url+" HTTP/1.1"),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),b.setRequestHeader("Pragma","cache=no"),b.setRequestHeader("Cache-Control","no-transform"),b.setRequestHeader("X-Requested-With","JaSper XMLHttpRequest"),b.overrideMimeType&&b.overrideMimeType("text/xml; charset=utf-8");for(var c in a.cabeceras)b.setRequestHeader(c,a.cabeceras[c]);b.responseType=a.returnData;var d=a.valores;if("object"==typeof a.valores){var e=[];for(var f in a.valores)e[e.length]=encodeURIComponent(f)+"="+encodeURIComponent(a.valores[f]);d=e.join("&")}b.send(d);var g=function(){return b.readyState<4?(JaSper.log("-JaSper::ajax.send- Peticion recibida, ajax.readyState = "+b.readyState+"; ajax.responseText = "+(b.responseText?b.responseText:"")),a.cbStart(a.elementoDom,b)):4==b.readyState?200==b.status?(JaSper.log("-JaSper::ajax.send- Respuesta recibida, proceso completado"),a.cbEnd(a.elementoDom,b)):a.cbFail(a.elementoDom,b):void 0};a.asincrono?4===b.readyState?setTimeout(g,0):b.onreadystatechange=g:g()}};
