/*! JaSper v3.4 | (c) 2015 José M. Carnero (sargazos.net) | JaSper_ajax v1.0 */
JaSper.extend(JaSper.langs,{en:{"ajax/ajax_1":"This browser can't create AJAX objects.","ajax/ajax_2":"Loading","ajax/ajax_3":"The AJAX request was empty.\nMaybe the destination URL is not accesible from this script.","ajax/ajax_4":"Unauthorized (code 401).","ajax/ajax_5":"Forbidden (code 403).","ajax/ajax_6":"Not Found (code 404).","ajax/ajax_7":"Error"},es:{"ajax/ajax_1":"Su navegador no puede crear objetos AJAX.","ajax/ajax_2":"Cargando","ajax/ajax_3":"La respuesta AJAX está vacía.\nPuede que la URL de destino no sea accesible desde esta máquina/dominio.","ajax/ajax_4":"No tiene autorización (código 401).","ajax/ajax_5":"Acceso no permitido (código 403).","ajax/ajax_6":"La dirección no existe (código 404).","ajax/ajax_7":"Error"}}),JaSper.extend(JaSper.prototype,{ajax:function(a,e,t){"use strict";if("object"==typeof a)var r=a,a=r.url||null,o=r.cabeceras||{},e=r.valores||null,t=r.metodo||null,n=r.asincrono||null,s=r.formatoDatos||"text",c=r.cbEnd||null,x=r.cbStart||null,p=r.cbFail||null;return c=c||function(a,e){"INPUT"==a.tagName?a.value=e.responseText:a.innerHTML=e.responseText},x=x||function(a){a.innerHTML=JaSper._t("ajax/ajax_2")+"..."},p=p||function(a,e){switch(e.status){case 0:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_3"),1),a.innerHTML=JaSper._t("ajax/ajax_3");break;case 401:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_4"),1),a.innerHTML=JaSper._t("ajax/ajax_4");break;case 403:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_5"),1),a.innerHTML=JaSper._t("ajax/ajax_5");break;case 404:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_6"),1),a.innerHTML=JaSper._t("ajax/ajax_6");break;default:JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_7")+": "+e.status+", "+e.statusText+" ("+e.responseText+")",2),a.innerHTML=JaSper._t("ajax/ajax_7")+": "+e.status}},this.each(function(a,e,t,r,o,n){JaSper.ajax.send({url:a,cabeceras:e,valores:t,metodo:r,asincrono:o,formatoDatos:n,elementoDom:this,cbEnd:c,cbFail:p,cbStart:x})},[a,o,e,t,n,s]),this}}),JaSper.ajax={nuevo:function(){"use strict";var a=!1;if("undefined"!=typeof XMLHttpRequest)a=new XMLHttpRequest;else try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){try{a=new ActiveXObject("Msxml2.XMLHTTP.4.0")}catch(r){JaSper.log("-JaSper::ajax- "+JaSper._t("ajax/ajax_1"),2)}}}return a||JaSper.log("-JaSper::nuevoAjax- No se pudo crear el objeto AJAX.",2),a},send:function(a){"use strict";if("object"!=typeof a||!a.url)return JaSper.log("-JaSper::ajax.send- Sin URL que consultar",1),!1;a.cabeceras=a.cabeceras||{},a.valores=a.valores||null,a.metodo=(a.metodo||"get").toUpperCase(),a.asincrono="boolean"!=typeof a.asincrono?!0:a.asincrono,a.returnData=a.returnData||"text",a.elementoDom=a.elementoDom||null,a.cbEnd=a.cbEnd||function(a,e){JaSper.log(e.responseText)},a.cbStart=a.cbStart||function(){JaSper.log(JaSper._t("ajax/ajax_2")+"...")},a.cbFail=a.cbFail||function(a,e){switch(e.status){case 0:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_3"),1);break;case 401:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_4"),1);break;case 403:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_5"),1);break;case 404:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_6"),1);break;default:JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_7")+": "+e.status+", "+e.statusText+" ("+e.responseText+")",2)}};var e=JaSper.ajax.nuevo();if(!e)return JaSper.log("-JaSper::ajax.send- "+JaSper._t("ajax/ajax_1")),a.elementoDom&&(a.elementoDom.innerHTML=JaSper._t("ajax/ajax_1")),!1;e.open(a.metodo,a.url,a.asincrono),"POST"==a.metodo&&(e.setRequestHeader("Method","POST "+a.url+" HTTP/1.1"),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),e.setRequestHeader("Pragma","cache=no"),e.setRequestHeader("Cache-Control","no-transform"),e.setRequestHeader("X-Requested-With","JaSper XMLHttpRequest"),e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8");for(var t in a.cabeceras)e.setRequestHeader(t,a.cabeceras[t]);e.responseType=a.returnData;var r=a.valores;if("object"==typeof a.valores){var o=[];for(var n in a.valores)o[o.length]=encodeURIComponent(n)+"="+encodeURIComponent(a.valores[n]);r=o.join("&")}e.send(r);var s=function(){return e.readyState<4?(JaSper.log("-JaSper::ajax.send- Peticion recibida, ajax.readyState = "+e.readyState+"; ajax.responseText = "+(e.responseText?e.responseText:"")),a.cbStart(a.elementoDom,e)):4==e.readyState?200==e.status?(JaSper.log("-JaSper::ajax.send- Respuesta recibida, proceso completado"),a.cbEnd(a.elementoDom,e)):a.cbFail(a.elementoDom,e):void 0};a.asincrono?4===e.readyState?setTimeout(s,0):e.onreadystatechange=s:s()}};
