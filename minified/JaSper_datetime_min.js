/*! JaSper v3.5 | (c) 2015 José M. Carnero (sargazos.net) | JaSper_datetime v1.0 */
JaSper.extend(JaSper.prototype,{countdown:function(a,b){"use strict";a=a||Date.now()/1e3+100;var c=function(a,c,d){if(b)return a=a||null,b.apply(a,[c,d])},d=function(a,b){var e={seg:0,min:0,hor:0,dia:0,sem:0},f={seg:0,min:0,hor:0,dia:0,sem:0};e.seg=b-Date.now()/1e3,f.seg=Math.floor(e.seg%60),e.min=e.seg/60,f.min=Math.floor(e.min%60),e.hor=e.min/60,f.hor=Math.floor(e.hor%24),e.dia=e.hor/24,f.dia=Math.floor(e.dia%30),e.seg&&(a.seg.innerHTML=f.seg,c(a.seg,f.seg,60)),e.min&&(a.min.innerHTML=f.min,c(a.min,f.min,60)),e.hor&&(a.hor.innerHTML=f.hor,c(a.hor,f.hor,24)),e.dia&&(a.dia.innerHTML=Math.floor(e.dia),c(a.dia,Math.floor(e.dia),365));setTimeout(function(){d(a,b)},1e3)};return this.each(function(){var b=JaSper.nodo.crear("p",{class:"JaSper countdown"},this),c={dia:JaSper.nodo.crear("span",{class:"dias"},b),hor:JaSper.nodo.crear("span",{class:"horas"},b),min:JaSper.nodo.crear("span",{class:"minutos"},b),seg:JaSper.nodo.crear("span",{class:"segundos"},b)};d(c,a)}),this},datePicker:function(a){"use strict";a=a||{},a.contenedor=a.contenedor||"JaSperDatePicker",a.fechaMin=new Date(a.fechaMin||"1970-01-01"),a.fechaIni=new Date(a.fechaIni||new Date),a.fechaMax=new Date(a.fechaMax||"2222-01-01"),a.formato=a.formato||"yyyy-mm-dd",a.semana=a.semana||["Lunes","Martes","Miercoles","Jueves","Viernes","Sábado","Domingo"],a.semanaCorta=a.semanaCorta||["L","M","X","J","V","S","D"],a.mesesCorto=a.mesesCorto||["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];var b=function(a,b,c){var d=JaSper.nodo.crear("div",{innerHTML:b,class:c});if(1==a.nodeType)return a.parentNode.appendChild(d)},c=function(b){var c={t:b,a:b.getFullYear(),m:b.getMonth()+1,d:b.getDate()},d=c.a+"-"+("00"+(c.m-1)).slice(-2)+"-01";if(1==c.m)var d=c.a-1+"-12-01";var e=c.a+"-"+("00"+(c.m+1)).slice(-2)+"-01";if(12==c.m)var e=c.a+1+"-01-01";return[d,c.a+" - "+a.mesesCorto[c.m],e]},d=function(b){var c={t:b,a:b.getFullYear(),m:b.getMonth()+1,d:b.getDate()},d=new Date(c.a,c.m-1,1).getDay()-1;d=d<0?6:d;var e=JaSper.datetime.diasEnMes(c.t),f=[c.a,c.t.getMonth()-1];f<0&&(f[0]=f[0]--,f[1]=11);for(var g=JaSper.datetime.diasEnMes(f[0],f[1]),h=" data-"+a.contenedor,i="",j=-d;j<e;){for(var k="<tr>",l=0;l<a.semanaCorta.length;l++){var m,n=c.a,o=c.m,p=j+l+1;p<=0?(p=g+p,--o<1&&(n--,o=12),m="mesPasado"):p>e?(p-=e,++o>12&&(n++,o=1),m="mesSiguiente"):m="mesActual",k+='<td class="'+m+'"'+h+'="'+(n+"-"+o+"-"+p)+'">'+p+"</td>"}j+=l,k+="</tr>",i+=k}return i},e=function(b){var f=({t:b,a:b.getFullYear(),m:b.getMonth()+1,d:b.getDate()}," data-"+a.contenedor),g=c(b),h="<table>";h+='<caption><span class="butMesAnterior"'+f+'="'+g[0]+'">&lt;&lt;</span>&nbsp;&nbsp;&nbsp;<span class="mesActual">'+g[1]+'</span>&nbsp;&nbsp;&nbsp;<span class="butMesSiguiente"'+f+'="'+g[2]+'">&gt;&gt;</span></caption>',h+="<thead><tr>";for(var i=0;i<a.semanaCorta.length;i++)h+="<td>"+a.semanaCorta[i]+"</td>";return h+="</tr></thead>",h+="<tbody>",h+=d(b),h+="</tbody>",h+="</table>"};return this.each(function(a,e){var f="data-"+e,g=this,h=b(this,a,e);JaSper(g).eventAdd("click",function(a){h.style.display="block"});var i=function(a){h.style.display="none",g.value=JaSper.nodo.attrib(this,f)};JaSper("tbody td.mesPasado, tbody td.mesActual, tbody td.mesSiguiente",h).eventAdd("click",i),JaSper("caption span.butMesAnterior, caption span.butMesSiguiente",h).eventAdd("click",function(a){JaSper("tbody td.mesPasado, tbody td.mesActual, tbody td.mesSiguiente",h).eventRemove("click",i);var b=new Date(JaSper.nodo.attrib(this,f));JaSper("tbody",h).html(d(b));var e=c(b);JaSper("caption span.butMesAnterior",h).attrib(f,e[0]),JaSper("caption span.mesActual",h).html(e[1]),JaSper("caption span.butMesSiguiente",h).attrib(f,e[2]),JaSper("tbody td.mesPasado, tbody td.mesActual, tbody td.mesSiguiente",h).eventAdd("click",i)})},[e(a.fechaIni),a.contenedor]),this},timePicker:function(a){"use strict";return a=a||{},this.each(function(){return JaSper.anim.fade(this,oTipo,iMiliSec)}),this}}),JaSper.datetime={diasEnMes:function(a,b){"use strict";if(JaSper.datetime.esFecha(a)&&(b=a.getMonth(),a=a.getFullYear()),!JaSper.funcs.isNumber(a)||!JaSper.funcs.isNumber(b))return!1;var c=Math.ceil((b-11)/12);return b=c>0?11:c<0?0:b,a+=c,[31,JaSper.datetime.esBisiesto(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},esBisiesto:function(a){"use strict";return a%4===0&&a%100!==0||a%400===0},esFecha:function(a){"use strict";return/Date/.test(Object.prototype.toString.call(a))&&!isNaN(a.getTime())},esFinde:function(a){"use strict";var b=a.getDay();return 0===b||6===b}};
